#!/bin/bash
"""
Dragonæœºå™¨äººçŸ¥è¯†åº“å¿«é€Ÿè®¾ç½®è„šæœ¬
"""

echo "ðŸ§  Dragonæœºå™¨äººæœ¬åœ°çŸ¥è¯†åº“è®¾ç½®"
echo "=================================="

# æ£€æŸ¥PythonçŽ¯å¢ƒ
echo "ðŸ“¦ æ£€æŸ¥PythonçŽ¯å¢ƒ..."
python3 --version
if [ $? -ne 0 ]; then
    echo "âŒ Python3æœªå®‰è£…"
    exit 1
fi

# å®‰è£…çŸ¥è¯†åº“ä¾èµ–
echo "ðŸ“¦ å®‰è£…çŸ¥è¯†åº“ä¾èµ–..."
pip3 install -r requirements_knowledge.txt

if [ $? -eq 0 ]; then
    echo "âœ… ä¾èµ–å®‰è£…æˆåŠŸ"
else
    echo "âš ï¸ éƒ¨åˆ†ä¾èµ–å®‰è£…å¤±è´¥ï¼Œå°è¯•å•ç‹¬å®‰è£…..."
    pip3 install sentence-transformers scikit-learn numpy PyPDF2 python-docx pandas python-dotenv
fi

# åˆ›å»ºçŸ¥è¯†åº“ç›®å½•ç»“æž„
echo "ðŸ“ åˆ›å»ºçŸ¥è¯†åº“ç›®å½•..."
mkdir -p knowledge_base/{documents,metadata,indices}
mkdir -p docs/{manuals,guides,references}

echo "âœ… çŸ¥è¯†åº“ç›®å½•åˆ›å»ºå®Œæˆ"

# åˆ›å»ºç¤ºä¾‹æ–‡æ¡£
echo "ðŸ“„ åˆ›å»ºç¤ºä¾‹æ–‡æ¡£..."

cat > docs/manuals/robot_manual.txt << 'EOF'
Dragonæœºå™¨äººæ“ä½œæ‰‹å†Œ

## åŸºæœ¬æŽ§åˆ¶æŒ‡ä»¤
- å‰è¿›ï¼šæœºå™¨äººå‘å‰ç§»åŠ¨
- åŽé€€ï¼šæœºå™¨äººå‘åŽç§»åŠ¨  
- å·¦è½¬ï¼šæœºå™¨äººå‘å·¦è½¬å‘
- å³è½¬ï¼šæœºå™¨äººå‘å³è½¬å‘
- åœæ­¢ï¼šæœºå™¨äººåœæ­¢æ‰€æœ‰è¿åŠ¨

## å®‰å…¨æ³¨æ„äº‹é¡¹
1. æ“ä½œå‰ç¡®ä¿å‘¨å›´çŽ¯å¢ƒå®‰å…¨
2. é¿å…åœ¨ç‹­å°ç©ºé—´å†…é«˜é€Ÿç§»åŠ¨
3. å‘çŽ°å¼‚å¸¸ç«‹å³ä½¿ç”¨åœæ­¢æŒ‡ä»¤
4. å®šæœŸæ£€æŸ¥æœºå™¨äººçŠ¶æ€

## ç»´æŠ¤æŒ‡å—
- æ¯æ—¥æ£€æŸ¥ç”µæ± ç”µé‡
- å®šæœŸæ¸…æ´ä¼ æ„Ÿå™¨
- æ£€æŸ¥å…³èŠ‚æ¶¦æ»‘æƒ…å†µ
- è½¯ä»¶æ›´æ–°å’Œæ—¥å¿—æ£€æŸ¥
EOF

cat > docs/guides/voice_commands.md << 'EOF'
# è¯­éŸ³æŒ‡ä»¤æŒ‡å—

## åŸºæœ¬ç§»åŠ¨æŒ‡ä»¤
- "æœºå™¨äººå‰è¿›" / "å¾€å‰èµ°" / "å‘å‰ç§»åŠ¨"
- "æœºå™¨äººåŽé€€" / "å¾€åŽé€€" / "å‘åŽç§»åŠ¨"  
- "æœºå™¨äººå·¦è½¬" / "å‘å·¦è½¬" / "å¾€å·¦è½¬"
- "æœºå™¨äººå³è½¬" / "å‘å³è½¬" / "å¾€å³è½¬"
- "æœºå™¨äººåœæ­¢" / "åœä¸‹æ¥" / "ä¸è¦åŠ¨"

## å¯¹è¯åŠŸèƒ½
- å¯ä»¥ä¸Žæœºå™¨äººè¿›è¡Œè‡ªç„¶å¯¹è¯
- è¯¢é—®æŠ€æœ¯é—®é¢˜ä¼šåŸºäºŽçŸ¥è¯†åº“å›žç­”
- æ”¯æŒä¸­æ–‡è¯­éŸ³è¯†åˆ«å’Œè¯­éŸ³å›žå¤

## æ³¨æ„äº‹é¡¹
- è¯´è¯è¦æ¸…æ™°ï¼Œé¿å…èƒŒæ™¯å™ªéŸ³
- æŒ‡ä»¤è¦ç®€æ´æ˜Žç¡®
- ç­‰å¾…æœºå™¨äººæ‰§è¡Œå®Œæˆå†å‘å‡ºä¸‹ä¸€ä¸ªæŒ‡ä»¤
EOF

cat > docs/references/faq.txt << 'EOF'
å¸¸è§é—®é¢˜è§£ç­”

Q: æœºå™¨äººä¸å“åº”è¯­éŸ³æŒ‡ä»¤æ€Žä¹ˆåŠžï¼Ÿ
A: æ£€æŸ¥éº¦å…‹é£Žæ˜¯å¦æ­£å¸¸å·¥ä½œï¼Œç¡®ä¿ç½‘ç»œè¿žæŽ¥ç¨³å®šï¼Œè¯­éŸ³è¦æ¸…æ™°ã€‚

Q: å¦‚ä½•æ·»åŠ æ–°çš„æŽ§åˆ¶æŒ‡ä»¤ï¼Ÿ
A: åœ¨ä»£ç ä¸­ä¿®æ”¹command_mapå­—å…¸ï¼Œæ·»åŠ æ–°çš„æŒ‡ä»¤æ˜ å°„ã€‚

Q: è¯­éŸ³è¯†åˆ«ä¸å‡†ç¡®æ€Žä¹ˆåŠžï¼Ÿ
A: è¯´è¯æ—¶è¦æ¸…æ™°ï¼Œé¿å…æ–¹è¨€ï¼Œç¡®ä¿çŽ¯å¢ƒå®‰é™ã€‚

Q: å¦‚ä½•æ›´æ–°çŸ¥è¯†åº“ï¼Ÿ
A: ä½¿ç”¨knowledge_manager.pyå·¥å…·æ·»åŠ æ–°æ–‡æ¡£åˆ°çŸ¥è¯†åº“ã€‚

Q: æœºå™¨äººç§»åŠ¨å¼‚å¸¸æ€Žä¹ˆåŠžï¼Ÿ
A: ç«‹å³ä½¿ç”¨"åœæ­¢"æŒ‡ä»¤ï¼Œæ£€æŸ¥ç¡¬ä»¶è¿žæŽ¥å’ŒROSçŠ¶æ€ã€‚
EOF

echo "âœ… ç¤ºä¾‹æ–‡æ¡£åˆ›å»ºå®Œæˆ"

# æµ‹è¯•çŸ¥è¯†åº“åŠŸèƒ½
echo "ðŸ§ª æµ‹è¯•çŸ¥è¯†åº“åŠŸèƒ½..."
python3 knowledge_manager.py --add-dir docs/ --category "ç³»ç»Ÿæ–‡æ¡£"

if [ $? -eq 0 ]; then
    echo "âœ… çŸ¥è¯†åº“æµ‹è¯•æˆåŠŸ"
    
    # æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
    echo "ðŸ“Š çŸ¥è¯†åº“çŠ¶æ€:"
    python3 knowledge_manager.py --stats
    
    echo ""
    echo "ðŸŽ¯ å¿«é€Ÿæµ‹è¯•æœç´¢:"
    python3 knowledge_manager.py --search "æœºå™¨äººæ“ä½œæ–¹æ³•" --top-k 2
    
else
    echo "âš ï¸ çŸ¥è¯†åº“æµ‹è¯•å¤±è´¥ï¼Œè¯·æ£€æŸ¥ä¾èµ–å®‰è£…"
fi

echo ""
echo "âœ… Dragonæœºå™¨äººçŸ¥è¯†åº“è®¾ç½®å®Œæˆï¼"
echo ""
echo "ðŸ“š ä½¿ç”¨æ–¹æ³•:"
echo "1. æ·»åŠ æ–‡æ¡£: python3 knowledge_manager.py --add your_document.pdf"
echo "2. æœç´¢æµ‹è¯•: python3 knowledge_manager.py --search 'ä½ çš„é—®é¢˜'"
echo "3. æŸ¥çœ‹æ–‡æ¡£: python3 knowledge_manager.py --list"
echo "4. å¯åŠ¨ç³»ç»Ÿ: python3 dragon_robot_session.py"
echo ""
echo "ðŸŽ¤ çŽ°åœ¨ä½ å¯ä»¥å¯¹æœºå™¨äººè¯´è¯äº†ï¼Œå®ƒä¼šåŸºäºŽçŸ¥è¯†åº“æ™ºèƒ½å›žç­”ï¼"
